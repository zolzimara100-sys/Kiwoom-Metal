[ë°ì´í„° ìˆ˜ì§‘ ì¡°ê±´]

ìµœì´ˆ stk-cdì˜ max(dt),ì™€ min(date)ë¥¼ ì¡°íšŒí•´ì„œ ë³€ìˆ˜ì— ì €ì¥í•´ ë†“ì•„ì•¼ í•¨. 
ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê¸° ê¸°ë³¸ ë³€ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ. 
1. Min Target Date  : ê³ ì •ì„. 2000-01-02. 
2. Max Target Date : ì˜¤ëŠ˜ ë‚ ì§œ, ì„œë²„ì— ìš”ì²­ì„ ì‹œì‘í•´ì•¼ í•  ìµœì´ˆì˜ request date 
3. Min Stock Date : tb_stock_investor_chartì—ì„œ stk_cdì˜ Min(dt) ê°’
4. Max Stock Date : tb_stock_investor_chartì—ì„œ stk_cdì˜ Max(dt) ê°’

[ì°¸ê³ ] kiwoom serverì— requet stk_cdì— ëŒ€í•œ response dataëŠ” ì—­ë°©í–¥ìœ¼ë¡œ ìˆ˜ì‹  ì¦‰ request(dt)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³¼ê±°ë°ì´í„° 100ê°œ ìˆ˜ì‹ .

ka 10060 ì„œë²„ì— ë°ì´í„° ìš”ì²­ì€ 2ê°€ì§€ ë¡œì§ì²˜ë¦¬ë¥¼ í•´ì•¼ í•¨. 

[ìµœì‹ ë°ì´í„° ë¶€í„°ê°€ì ¸ì˜¤ê¸°]
name : class í˜¹ì€ í•¨ìˆ˜ GetData ( Max Stock Date  Max Target Date )
1. ìµœì´ˆ Max Target Dateë¥¼ ì—°ì† ìš”ì²­í•´ì„œ Max Stock Date ê¹Œì§€ì˜ ë°ì´í„°ë§Œ ìš”ì²­. 
   ì¦‰ ì„œë²„ìˆ˜ì‹  ë°ì´í„° <= Max Stock Date ì¡°ê±´ì˜ ë°ì´í„°ëŠ”  databaseì— insertí•˜ì§€ ì•Šê³  ë©ˆì¶”ê³  ëë‚¸ë‹¤.
 

[ê³¼ê±°ë°ì´í„° ë¶€í„°ê°€ì ¸ì˜¤ê¸°]
name : class í˜¹ì€ í•¨ìˆ˜ GetData (  Min Target Date, Min Stock Date ) íŒŒë¼ë©”í„°ë¥¼ ë³€ê²½í•˜ì—¬ í•œë²ˆ ë” í˜¸ì¶œ.
1. ìµœì´ˆ Min Stock Date -1ì¼ì„ ì—°ì†ìš”ì²­í•´ì„œ  Min Target Date ê¹Œì§€ì˜ ë°ì´í„°ë§Œ ìš”ì²­. 
 ì¦‰ ì„œë²„ìˆ˜ì‹  ë°ì´í„° <=Min Target Date  ì¡°ê±´ì˜ ë°ì´í„°ëŠ” databaseì— insertí•˜ì§€ ì•Šê³  ë©ˆì¶”ê³  ëë‚¸ë‹¤.


ê°€ì¹­ "class í˜¹ì€ í•¨ìˆ˜ GetData" ì˜ ì—­í• ì€ ë‹¨ì§€ 2ê°œì˜ ë‚ ì§œë¥¼ ê°€ì§€ê³  ì™€ì„œ ì„œë²„ì— ì—°ì†ë°ì´í„°ë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒë¿ì„. 
ì„œë²„ìš”ì²­ì— ëŒ€í•œ ì œì•½ì‚¬í•­ sleep ì€ í˜„ì¬ì™€ ë™ì¼. 

ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë˜ë‹¤ë¥¸ í•¨ìˆ˜ëŠ” ëª‡ê°œì˜ ì¢…ëª©ì„ ì²˜ë¦¬í•  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•˜ëŠ” ê²ƒì„.
name : class í˜¹ì€ í•¨ìˆ˜ howmanystock
http://localhost:3000/data-collection ì—ì„œ "ì¢…ëª©" ì„ íƒì¼ ê²½ìš°ì—ëŠ” í•˜ë‚˜ì˜ ì¢…ëª©ë§Œ ì²˜ë¦¬, KOSPI200ì´ë©´ tb_stock_list_meta í…Œì´ë¸”ì˜ code(ì¢…ëª©ì½”ë“œ)ì •ë³´ë¥¼ ì°¸ê³ í•´ì„œ request stk_cdì— ë„£ì–´ requstí•˜ë©´ëœë‹¤. 
ì²˜ë¡œì§ì„ ë¶„ë¦¬í•  í•„ìš”ëŠ” ì—†ê³  Mapì— 1ê°œë¥¼ ë„£ëŠëƒ 200ê°œë¥¼ ë„£ëŠëƒì˜ ì°¨ì´ì´ë¯€ë¡œ ë™ì¼í•˜ê²Œ ì²˜ë¦¬.



[Github Copilot- Opus4.5 preview]
ìš”êµ¬ì‚¬í•­ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì´ì œ í˜„ì¬ êµ¬í˜„ëœ ë¡œì§ê³¼ ë¹„êµ ë¶„ì„í•˜ê² ìŠµë‹ˆë‹¤.

ğŸ“‹ ìš”êµ¬ì‚¬í•­ vs í˜„ì¬ êµ¬í˜„ ë¹„êµ ë¶„ì„
ìš”êµ¬ì‚¬í•­ ì •ë¦¬
ë³€ìˆ˜	ì„¤ëª…	ê°’
Min Target Date	ê³ ì •	2000-01-02
Max Target Date	ì˜¤ëŠ˜ ë‚ ì§œ	(ë™ì )
Min Stock Date	DBì˜ stk_cdë³„ Min(dt)	(DB ì¡°íšŒ)
Max Stock Date	DBì˜ stk_cdë³„ Max(dt)	(DB ì¡°íšŒ)
ìš”êµ¬ë˜ëŠ” 2ê°€ì§€ ë¡œì§
ë¡œì§	ìš”êµ¬ì‚¬í•­	í˜„ì¬ êµ¬í˜„ ìƒíƒœ
[ìµœì‹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°]	Max Target Date(ì˜¤ëŠ˜) â†’ Max Stock Dateê¹Œì§€ ì—­ë°©í–¥ ìˆ˜ì§‘<br>ìˆ˜ì‹  dt <= Max Stock Dateì´ë©´ ë©ˆì¶”ê³  ëëƒ„	âŒ ë¯¸êµ¬í˜„
[ê³¼ê±°ë°ì´í„° ê°€ì ¸ì˜¤ê¸°]	(Min Stock Date - 1ì¼) â†’ Min Target Date(2000-01-02)ê¹Œì§€ ì—­ë°©í–¥ ìˆ˜ì§‘<br>ìˆ˜ì‹  dt <= Min Target Dateì´ë©´ ë©ˆì¶”ê³  ëëƒ„	âš ï¸ ë¶€ë¶„ êµ¬í˜„ (ë‚ ì§œ ì²´í¬ ëˆ„ë½)
í˜„ì¬ êµ¬í˜„ ë¶„ì„ (fetchStockUntilTargetDate)

// í˜„ì¬ ì½”ë“œ (ë¼ì¸ 857-875)
if (oldestDate == null) {
    startDate = LocalDate.now();  // DBì— ë°ì´í„° ì—†ìŒ â†’ ì˜¤ëŠ˜ë¶€í„°
} else if (oldestDate.isAfter(targetStartDate)) {
    startDate = oldestDate.minusDays(1);  // ê³¼ê±° ë°©í–¥ë§Œ ì²˜ë¦¬
} else {
    // ìŠ¤í‚µ (ì´ë¯¸ ì™„ë£Œ)
}
ë¬¸ì œì  ìš”ì•½
#	ë¬¸ì œì 	ìƒì„¸
1	ìµœì‹  ë°ì´í„° ìˆ˜ì§‘ ëˆ„ë½	Max Stock Date â†’ ì˜¤ëŠ˜ê¹Œì§€ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŒ
2	ì—°ì†ì¡°íšŒ ì¤‘ë‹¨ ì¡°ê±´ ëˆ„ë½	ìˆ˜ì‹  dtê°€ ëª©í‘œ ë‚ ì§œ ì´ì „ì´ë©´ ë©ˆì¶°ì•¼ í•˜ëŠ”ë°, í˜„ì¬ëŠ” cont-yn í—¤ë”ë§Œ í™•ì¸
3	ë°ì´í„° í•„í„°ë§ ëˆ„ë½	ëª©í‘œ ë²”ìœ„ ë°– ë°ì´í„°ëŠ” DBì— insertí•˜ì§€ ë§ì•„ì•¼ í•˜ëŠ”ë°, í˜„ì¬ëŠ” ëª¨ë“  ë°ì´í„° ì €ì¥
[ìˆ˜ì • 1] ì–‘ë°©í–¥ ìˆ˜ì§‘ êµ¬í˜„
- GetRecentData(maxStockDate, maxTargetDate): ìµœì‹  ë°ì´í„° ìˆ˜ì§‘
- GetPastData(minTargetDate, minStockDate): ê³¼ê±° ë°ì´í„° ìˆ˜ì§‘

[ìˆ˜ì • 2] ì—°ì†ì¡°íšŒ ì¤‘ë‹¨ ì¡°ê±´ ì¶”ê°€
- fetchSingleDateWithContinuationFluxì—ì„œ:
  - ìˆ˜ì‹  dt <= stopDate ì´ë©´ ì—°ì†ì¡°íšŒ ì¤‘ë‹¨
  - í•´ë‹¹ ë°ì´í„°ëŠ” DB insert ì œì™¸

[ìˆ˜ì • 3] í˜¸ì¶œ êµ¬ì¡°
- fetchStockUntilTargetDateì—ì„œ ë‘ í•¨ìˆ˜ë¥¼ ìˆœì°¨ í˜¸ì¶œ:
  1. GetRecentData ë¨¼ì € ì‹¤í–‰ (ìµœì‹  â†’ ê¸°ì¡´ Maxê¹Œì§€)
  2. GetPastData ì‹¤í–‰ (ê¸°ì¡´ Min-1 â†’ 2000-01-02ê¹Œì§€)


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  tb_stock_list_metaì—ì„œ KOSPI200 ì¢…ëª© ì½”ë“œ ëª©ë¡ â†’ Mapì— ì €ì¥     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  For Each ì¢…ëª©(stk_cd) in Map:                                   â”‚
â”‚                                                                  â”‚
â”‚  1. tb_stock_investor_chartì—ì„œ í•´ë‹¹ ì¢…ëª©ì˜ ë‚ ì§œ ë²”ìœ„ ì¡°íšŒ        â”‚
â”‚     - minStockDate = Min(dt) where stk_cd = ì¢…ëª©ì½”ë“œ             â”‚
â”‚     - maxStockDate = Max(dt) where stk_cd = ì¢…ëª©ì½”ë“œ             â”‚
â”‚                                                                  â”‚
â”‚  2. ê³ ì • ë³€ìˆ˜                                                    â”‚
â”‚     - minTargetDate = 2000-01-02 (ê³ ì •)                          â”‚
â”‚     - maxTargetDate = ì˜¤ëŠ˜ ë‚ ì§œ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì¡°ê±´ 1] ìµœì‹  ë°ì´í„° ìˆ˜ì§‘ í•„ìš” ì—¬ë¶€ íŒë‹¨                         â”‚
â”‚                                                                  â”‚
â”‚  if (maxTargetDate == maxStockDate) {                            â”‚
â”‚      // ì´ë¯¸ ì˜¤ëŠ˜ê¹Œì§€ ìˆ˜ì§‘ë¨ â†’ ìµœì‹  ë°ì´í„° ìˆ˜ì§‘ SKIP              â”‚
â”‚  } else {                                                        â”‚
â”‚      // maxTargetDate > maxStockDate                             â”‚
â”‚      // â†’ GetRecentData(maxStockDate, maxTargetDate) í˜¸ì¶œ        â”‚
â”‚      // â†’ ìˆ˜ì‹  dt <= maxStockDate ì´ë©´ ì €ì¥ ì•ˆí•˜ê³  ì¤‘ë‹¨           â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì¡°ê±´ 2] ê³¼ê±° ë°ì´í„° ìˆ˜ì§‘ í•„ìš” ì—¬ë¶€ íŒë‹¨                         â”‚
â”‚                                                                  â”‚
â”‚  if (minTargetDate >= minStockDate) {                            â”‚
â”‚      // ì´ë¯¸ 2000-01-02ê¹Œì§€ ìˆ˜ì§‘ë¨ â†’ ê³¼ê±° ë°ì´í„° ìˆ˜ì§‘ SKIP        â”‚
â”‚  } else {                                                        â”‚
â”‚      // minTargetDate < minStockDate                             â”‚
â”‚      // â†’ GetPastData(minTargetDate, minStockDate) í˜¸ì¶œ          â”‚
â”‚      // â†’ ìˆ˜ì‹  dt <= minTargetDate ì´ë©´ ì €ì¥ ì•ˆí•˜ê³  ì¤‘ë‹¨          â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mapì—ì„œ ë‹¤ìŒ ì¢…ëª© ì„ íƒ â†’ ë°˜ë³µ                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¼€ì´ìŠ¤ë³„ ë™ì‘ ì˜ˆì‹œ
ì¼€ì´ìŠ¤	minStockDate	maxStockDate	ìµœì‹  ìˆ˜ì§‘	ê³¼ê±° ìˆ˜ì§‘
DB ë°ì´í„° ì—†ìŒ	null	null	âœ… ì˜¤ëŠ˜ë¶€í„°	âœ… 2000-01-02ê¹Œì§€
ì™„ì „ ìˆ˜ì§‘ë¨	2000-01-02	ì˜¤ëŠ˜	âŒ SKIP	âŒ SKIP
ìµœì‹ ë§Œ ë¶€ì¡±	2000-01-02	2024-12-01	âœ… ì˜¤ëŠ˜~12/01	âŒ SKIP
ê³¼ê±°ë§Œ ë¶€ì¡±	2010-02-03	ì˜¤ëŠ˜	âŒ SKIP	âœ… 2010/02/02~2000/01/02
ì–‘ìª½ ë¶€ì¡±	2010-02-03	2024-12-01	âœ… ì˜¤ëŠ˜~12/01	âœ… 2010/02/02~2000/01/02

 
[ì¼€ì´ìŠ¤ë³„ ë™ì‘ ì˜ˆì‹œ]
ë¡œì§ê°œë°œ ì´í›„ì— í•­ìƒ ì¼€ì´ìŠ¤ë³„ ë™ì‘ì˜ˆì‹œë¥¼ í…ŒìŠ¤íŠ¸ í•´ë³´ë„ë¡ í•´ì•¼ í•œë‹¤. 
